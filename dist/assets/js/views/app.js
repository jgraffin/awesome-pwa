!function(){"use strict";var e={isLoading:!0,visibleCards:{},selectedCities:[],spinner:document.querySelector(".loader"),cardTemplate:document.querySelector(".cardTemplate"),container:document.querySelector(".main"),addDialog:document.querySelector(".dialog-container"),daysOfWeek:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]};document.getElementById("butRefresh").addEventListener("click",function(){e.updateForecasts()}),document.getElementById("butAdd").addEventListener("click",function(){e.toggleAddDialog(!0)}),document.getElementById("butAddCity").addEventListener("click",function(){var t=document.getElementById("selectCityToAdd"),a=t.options[t.selectedIndex],c=a.value,r=a.textContent;e.selectedCities||(e.selectedCities=[]),e.getForecast(c,r),e.selectedCities.push({key:c,label:r}),e.saveSelectedCities(),e.toggleAddDialog(!1)}),document.getElementById("butAddCancel").addEventListener("click",function(){e.toggleAddDialog(!1)}),e.toggleAddDialog=function(t){t?e.addDialog.classList.add("dialog-container--visible"):e.addDialog.classList.remove("dialog-container--visible")},e.updateForecastCard=function(t){var a=new Date(t.created),c=t.channel.astronomy.sunrise,r=t.channel.astronomy.sunset,n=t.channel.item.condition,s=t.channel.atmosphere.humidity,o=t.channel.wind,i=e.visibleCards[t.key];i||(i=e.cardTemplate.cloneNode(!0),i.classList.remove("cardTemplate"),i.querySelector(".location").textContent=t.label,i.removeAttribute("hidden"),e.container.appendChild(i),e.visibleCards[t.key]=i);var d=i.querySelector(".card-last-updated"),l=d.textContent;if(!(l&&(l=new Date(l),a.getTime()<l.getTime()))){d.textContent=t.created,i.querySelector(".description").textContent=n.text,i.querySelector(".date").textContent=n.date,i.querySelector(".current .icon").classList.add(e.getIconClass(n.code)),i.querySelector(".current .temperature .value").textContent=Math.round(n.temp),i.querySelector(".current .sunrise").textContent=c,i.querySelector(".current .sunset").textContent=r,i.querySelector(".current .humidity").textContent=Math.round(s)+"%",i.querySelector(".current .wind .value").textContent=Math.round(o.speed),i.querySelector(".current .wind .direction").textContent=o.direction;var u=i.querySelectorAll(".future .oneday"),y=new Date;y=y.getDay();for(var h=0;h<7;h++){var g=u[h],m=t.channel.item.forecast[h];m&&g&&(g.querySelector(".date").textContent=e.daysOfWeek[(h+y)%7],g.querySelector(".icon").classList.add(e.getIconClass(m.code)),g.querySelector(".temp-high .value").textContent=Math.round(m.high),g.querySelector(".temp-low .value").textContent=Math.round(m.low))}e.isLoading&&(e.spinner.setAttribute("hidden",!0),e.container.removeAttribute("hidden"),e.isLoading=!1)}},e.getForecast=function(a,c){var r="select * from weather.forecast where woeid="+a,n="https://query.yahooapis.com/v1/public/yql?format=json&q="+r;"caches"in window&&caches.match(n).then(function(t){t&&t.json().then(function(t){var r=t.query.results;r.key=a,r.label=c,r.created=t.query.created,e.updateForecastCard(r)})});var s=new XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState===XMLHttpRequest.DONE){if(200===s.status){var r=JSON.parse(s.response),n=r.query.results;n.key=a,n.label=c,n.created=r.query.created,e.updateForecastCard(n)}}else e.updateForecastCard(t)},s.open("GET",n),s.send()},e.updateForecasts=function(){var t=Object.keys(e.visibleCards);t.forEach(function(t){e.getForecast(t)})},e.saveSelectedCities=function(){var t=JSON.stringify(e.selectedCities);localStorage.selectedCities=t},e.getIconClass=function(e){switch(e=parseInt(e)){case 25:case 32:case 33:case 34:case 36:case 3200:return"clear-day";case 0:case 1:case 2:case 6:case 8:case 9:case 10:case 11:case 12:case 17:case 35:case 40:return"rain";case 3:case 4:case 37:case 38:case 39:case 45:case 47:return"thunderstorms";case 5:case 7:case 13:case 14:case 16:case 18:case 41:case 42:case 43:case 46:return"snow";case 15:case 19:case 20:case 21:case 22:return"fog";case 24:case 23:return"windy";case 26:case 27:case 28:case 31:return"cloudy";case 29:case 30:case 44:return"partly-cloudy-day"}};var t={key:"2459115",label:"New York, NY",created:"2016-07-22T01:00:00Z",channel:{astronomy:{sunrise:"5:43 am",sunset:"8:21 pm"},item:{condition:{text:"Windy",date:"Thu, 21 Jul 2016 09:00 PM EDT",temp:56,code:24},forecast:[{code:44,high:86,low:70},{code:44,high:94,low:73},{code:4,high:95,low:78},{code:24,high:75,low:89},{code:24,high:89,low:77},{code:44,high:92,low:79},{code:44,high:89,low:77}]},atmosphere:{humidity:56},wind:{speed:25,direction:195}}};e.selectedCities=localStorage.selectedCities,e.selectedCities?(e.selectedCities=JSON.parse(e.selectedCities),e.selectedCities.forEach(function(t){e.getForecast(t.key,t.label)})):(e.updateForecastCard(t),e.selectedCities=[{key:t.key,label:t.label}],e.saveSelectedCities()),"serviceWorker"in navigator&&navigator.serviceWorker.register("./service-worker.js").then(function(){console.log("Service Worker Registered")})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJhcHAiLCJpc0xvYWRpbmciLCJ2aXNpYmxlQ2FyZHMiLCJzZWxlY3RlZENpdGllcyIsInNwaW5uZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjYXJkVGVtcGxhdGUiLCJjb250YWluZXIiLCJhZGREaWFsb2ciLCJkYXlzT2ZXZWVrIiwiZ2V0RWxlbWVudEJ5SWQiLCJhZGRFdmVudExpc3RlbmVyIiwidXBkYXRlRm9yZWNhc3RzIiwidG9nZ2xlQWRkRGlhbG9nIiwic2VsZWN0Iiwic2VsZWN0ZWQiLCJvcHRpb25zIiwic2VsZWN0ZWRJbmRleCIsImtleSIsInZhbHVlIiwibGFiZWwiLCJ0ZXh0Q29udGVudCIsImdldEZvcmVjYXN0IiwicHVzaCIsInNhdmVTZWxlY3RlZENpdGllcyIsInZpc2libGUiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJ1cGRhdGVGb3JlY2FzdENhcmQiLCJkYXRhIiwiZGF0YUxhc3RVcGRhdGVkIiwiRGF0ZSIsImNyZWF0ZWQiLCJzdW5yaXNlIiwiY2hhbm5lbCIsImFzdHJvbm9teSIsInN1bnNldCIsImN1cnJlbnQiLCJpdGVtIiwiY29uZGl0aW9uIiwiaHVtaWRpdHkiLCJhdG1vc3BoZXJlIiwid2luZCIsImNhcmQiLCJjbG9uZU5vZGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsImNhcmRMYXN0VXBkYXRlZEVsZW0iLCJjYXJkTGFzdFVwZGF0ZWQiLCJnZXRUaW1lIiwidGV4dCIsImRhdGUiLCJnZXRJY29uQ2xhc3MiLCJjb2RlIiwiTWF0aCIsInJvdW5kIiwidGVtcCIsInNwZWVkIiwiZGlyZWN0aW9uIiwibmV4dERheXMiLCJxdWVyeVNlbGVjdG9yQWxsIiwidG9kYXkiLCJnZXREYXkiLCJpIiwibmV4dERheSIsImRhaWx5IiwiZm9yZWNhc3QiLCJoaWdoIiwibG93Iiwic2V0QXR0cmlidXRlIiwic3RhdGVtZW50IiwidXJsIiwid2luZG93IiwiY2FjaGVzIiwibWF0Y2giLCJ0aGVuIiwicmVzcG9uc2UiLCJqc29uIiwicmVzdWx0cyIsInF1ZXJ5IiwicmVxdWVzdCIsIlhNTEh0dHBSZXF1ZXN0Iiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsIkRPTkUiLCJzdGF0dXMiLCJKU09OIiwicGFyc2UiLCJpbml0aWFsV2VhdGhlckZvcmVjYXN0Iiwib3BlbiIsInNlbmQiLCJrZXlzIiwiT2JqZWN0IiwiZm9yRWFjaCIsInN0cmluZ2lmeSIsImxvY2FsU3RvcmFnZSIsIndlYXRoZXJDb2RlIiwicGFyc2VJbnQiLCJjaXR5IiwibmF2aWdhdG9yIiwic2VydmljZVdvcmtlciIsInJlZ2lzdGVyIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6IkNBZUEsV0FDRSxZQUVBLElBQUlBLElBQ0ZDLFdBQVcsRUFDWEMsZ0JBQ0FDLGtCQUNBQyxRQUFTQyxTQUFTQyxjQUFjLFdBQ2hDQyxhQUFjRixTQUFTQyxjQUFjLGlCQUNyQ0UsVUFBV0gsU0FBU0MsY0FBYyxTQUNsQ0csVUFBV0osU0FBU0MsY0FBYyxxQkFDbENJLFlBQWEsTUFBTyxNQUFPLE1BQU8sTUFBTyxNQUFPLE1BQU8sT0FVekRMLFVBQVNNLGVBQWUsY0FBY0MsaUJBQWlCLFFBQVMsV0FFOURaLEVBQUlhLG9CQUdOUixTQUFTTSxlQUFlLFVBQVVDLGlCQUFpQixRQUFTLFdBRTFEWixFQUFJYyxpQkFBZ0IsS0FHdEJULFNBQVNNLGVBQWUsY0FBY0MsaUJBQWlCLFFBQVMsV0FFOUQsR0FBSUcsR0FBU1YsU0FBU00sZUFBZSxtQkFDakNLLEVBQVdELEVBQU9FLFFBQVFGLEVBQU9HLGVBQ2pDQyxFQUFNSCxFQUFTSSxNQUNmQyxFQUFRTCxFQUFTTSxXQUNoQnRCLEdBQUlHLGlCQUNQSCxFQUFJRyxtQkFFTkgsRUFBSXVCLFlBQVlKLEVBQUtFLEdBQ3JCckIsRUFBSUcsZUFBZXFCLE1BQU1MLElBQUtBLEVBQUtFLE1BQU9BLElBQzFDckIsRUFBSXlCLHFCQUNKekIsRUFBSWMsaUJBQWdCLEtBR3RC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cENILEVBQUlHLGVBQWU0RixRQUFRLFNBQVNLLEdBQ2xDcEcsRUFBSXVCLFlBQVk2RSxFQUFLakYsSUFBS2lGLEVBQUsvRSxXQVFqQ3JCLEVBQUk4QixtQkFBbUI0RCxHQUN2QjFGLEVBQUlHLGlCQUNEZ0IsSUFBS3VFLEVBQXVCdkUsSUFBS0UsTUFBT3FFLEVBQXVCckUsUUFFbEVyQixFQUFJeUIsc0JBSUYsaUJBQW1CNEUsWUFDckJBLFVBQVVDLGNBQ0FDLFNBQVMsdUJBQ1QxQixLQUFLLFdBQWEyQixRQUFRQyxJQUFJIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE2IEdvb2dsZSBJbmMuXG4vLyBcbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4vLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vIFxuLy8gICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vIFxuLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblxuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICB2YXIgYXBwID0ge1xuICAgIGlzTG9hZGluZzogdHJ1ZSxcbiAgICB2aXNpYmxlQ2FyZHM6IHt9LFxuICAgIHNlbGVjdGVkQ2l0aWVzOiBbXSxcbiAgICBzcGlubmVyOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubG9hZGVyJyksXG4gICAgY2FyZFRlbXBsYXRlOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZFRlbXBsYXRlJyksXG4gICAgY29udGFpbmVyOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbicpLFxuICAgIGFkZERpYWxvZzogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRpYWxvZy1jb250YWluZXInKSxcbiAgICBkYXlzT2ZXZWVrOiBbJ01vbicsICdUdWUnLCAnV2VkJywgJ1RodScsICdGcmknLCAnU2F0JywgJ1N1biddXG4gIH07XG5cblxuICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICpcbiAgICogRXZlbnQgbGlzdGVuZXJzIGZvciBVSSBlbGVtZW50c1xuICAgKlxuICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0UmVmcmVzaCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgLy8gUmVmcmVzaCBhbGwgb2YgdGhlIGZvcmVjYXN0c1xuICAgIGFwcC51cGRhdGVGb3JlY2FzdHMoKTtcbiAgfSk7XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dEFkZCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgLy8gT3Blbi9zaG93IHRoZSBhZGQgbmV3IGNpdHkgZGlhbG9nXG4gICAgYXBwLnRvZ2dsZUFkZERpYWxvZyh0cnVlKTtcbiAgfSk7XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dEFkZENpdHknKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgIC8vIEFkZCB0aGUgbmV3bHkgc2VsZWN0ZWQgY2l0eVxuICAgIHZhciBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsZWN0Q2l0eVRvQWRkJyk7XG4gICAgdmFyIHNlbGVjdGVkID0gc2VsZWN0Lm9wdGlvbnNbc2VsZWN0LnNlbGVjdGVkSW5kZXhdO1xuICAgIHZhciBrZXkgPSBzZWxlY3RlZC52YWx1ZTtcbiAgICB2YXIgbGFiZWwgPSBzZWxlY3RlZC50ZXh0Q29udGVudDtcbiAgICBpZiAoIWFwcC5zZWxlY3RlZENpdGllcykge1xuICAgICAgYXBwLnNlbGVjdGVkQ2l0aWVzID0gW107XG4gICAgfVxuICAgIGFwcC5nZXRGb3JlY2FzdChrZXksIGxhYmVsKTtcbiAgICBhcHAuc2VsZWN0ZWRDaXRpZXMucHVzaCh7a2V5OiBrZXksIGxhYmVsOiBsYWJlbH0pO1xuICAgIGFwcC5zYXZlU2VsZWN0ZWRDaXRpZXMoKTtcbiAgICBhcHAudG9nZ2xlQWRkRGlhbG9nKGZhbHNlKTtcbiAgfSk7XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dEFkZENhbmNlbCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgLy8gQ2xvc2UgdGhlIGFkZCBuZXcgY2l0eSBkaWFsb2dcbiAgICBhcHAudG9nZ2xlQWRkRGlhbG9nKGZhbHNlKTtcbiAgfSk7XG5cblxuICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICpcbiAgICogTWV0aG9kcyB0byB1cGRhdGUvcmVmcmVzaCB0aGUgVUlcbiAgICpcbiAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgLy8gVG9nZ2xlcyB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgYWRkIG5ldyBjaXR5IGRpYWxvZy5cbiAgYXBwLnRvZ2dsZUFkZERpYWxvZyA9IGZ1bmN0aW9uKHZpc2libGUpIHtcbiAgICBpZiAodmlzaWJsZSkge1xuICAgICAgYXBwLmFkZERpYWxvZy5jbGFzc0xpc3QuYWRkKCdkaWFsb2ctY29udGFpbmVyLS12aXNpYmxlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFwcC5hZGREaWFsb2cuY2xhc3NMaXN0LnJlbW92ZSgnZGlhbG9nLWNvbnRhaW5lci0tdmlzaWJsZScpO1xuICAgIH1cbiAgfTtcblxuICAvLyBVcGRhdGVzIGEgd2VhdGhlciBjYXJkIHdpdGggdGhlIGxhdGVzdCB3ZWF0aGVyIGZvcmVjYXN0LiBJZiB0aGUgY2FyZFxuICAvLyBkb2Vzbid0IGFscmVhZHkgZXhpc3QsIGl0J3MgY2xvbmVkIGZyb20gdGhlIHRlbXBsYXRlLlxuICBhcHAudXBkYXRlRm9yZWNhc3RDYXJkID0gZnVuY3Rpb24oZGF0YSkge1xuICAgIHZhciBkYXRhTGFzdFVwZGF0ZWQgPSBuZXcgRGF0ZShkYXRhLmNyZWF0ZWQpO1xuICAgIHZhciBzdW5yaXNlID0gZGF0YS5jaGFubmVsLmFzdHJvbm9teS5zdW5yaXNlO1xuICAgIHZhciBzdW5zZXQgPSBkYXRhLmNoYW5uZWwuYXN0cm9ub215LnN1bnNldDtcbiAgICB2YXIgY3VycmVudCA9IGRhdGEuY2hhbm5lbC5pdGVtLmNvbmRpdGlvbjtcbiAgICB2YXIgaHVtaWRpdHkgPSBkYXRhLmNoYW5uZWwuYXRtb3NwaGVyZS5odW1pZGl0eTtcbiAgICB2YXIgd2luZCA9IGRhdGEuY2hhbm5lbC53aW5kO1xuXG4gICAgdmFyIGNhcmQgPSBhcHAudmlzaWJsZUNhcmRzW2RhdGEua2V5XTtcbiAgICBpZiAoIWNhcmQpIHtcbiAgICAgIGNhcmQgPSBhcHAuY2FyZFRlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgIGNhcmQuY2xhc3NMaXN0LnJlbW92ZSgnY2FyZFRlbXBsYXRlJyk7XG4gICAgICBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5sb2NhdGlvbicpLnRleHRDb250ZW50ID0gZGF0YS5sYWJlbDtcbiAgICAgIGNhcmQucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcbiAgICAgIGFwcC5jb250YWluZXIuYXBwZW5kQ2hpbGQoY2FyZCk7XG4gICAgICBhcHAudmlzaWJsZUNhcmRzW2RhdGEua2V5XSA9IGNhcmQ7XG4gICAgfVxuXG4gICAgLy8gVmVyaWZpZXMgdGhlIGRhdGEgcHJvdmlkZSBpcyBuZXdlciB0aGFuIHdoYXQncyBhbHJlYWR5IHZpc2libGVcbiAgICAvLyBvbiB0aGUgY2FyZCwgaWYgaXQncyBub3QgYmFpbCwgaWYgaXQgaXMsIGNvbnRpbnVlIGFuZCB1cGRhdGUgdGhlXG4gICAgLy8gdGltZSBzYXZlZCBpbiB0aGUgY2FyZFxuICAgIHZhciBjYXJkTGFzdFVwZGF0ZWRFbGVtID0gY2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZC1sYXN0LXVwZGF0ZWQnKTtcbiAgICB2YXIgY2FyZExhc3RVcGRhdGVkID0gY2FyZExhc3RVcGRhdGVkRWxlbS50ZXh0Q29udGVudDtcbiAgICBpZiAoY2FyZExhc3RVcGRhdGVkKSB7XG4gICAgICBjYXJkTGFzdFVwZGF0ZWQgPSBuZXcgRGF0ZShjYXJkTGFzdFVwZGF0ZWQpO1xuICAgICAgLy8gQmFpbCBpZiB0aGUgY2FyZCBoYXMgbW9yZSByZWNlbnQgZGF0YSB0aGVuIHRoZSBkYXRhXG4gICAgICBpZiAoZGF0YUxhc3RVcGRhdGVkLmdldFRpbWUoKSA8IGNhcmRMYXN0VXBkYXRlZC5nZXRUaW1lKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICBjYXJkTGFzdFVwZGF0ZWRFbGVtLnRleHRDb250ZW50ID0gZGF0YS5jcmVhdGVkO1xuXG4gICAgY2FyZC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKS50ZXh0Q29udGVudCA9IGN1cnJlbnQudGV4dDtcbiAgICBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5kYXRlJykudGV4dENvbnRlbnQgPSBjdXJyZW50LmRhdGU7XG4gICAgY2FyZC5xdWVyeVNlbGVjdG9yKCcuY3VycmVudCAuaWNvbicpLmNsYXNzTGlzdC5hZGQoYXBwLmdldEljb25DbGFzcyhjdXJyZW50LmNvZGUpKTtcbiAgICBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jdXJyZW50IC50ZW1wZXJhdHVyZSAudmFsdWUnKS50ZXh0Q29udGVudCA9XG4gICAgICBNYXRoLnJvdW5kKGN1cnJlbnQudGVtcCk7XG4gICAgY2FyZC5xdWVyeVNlbGVjdG9yKCcuY3VycmVudCAuc3VucmlzZScpLnRleHRDb250ZW50ID0gc3VucmlzZTtcbiAgICBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jdXJyZW50IC5zdW5zZXQnKS50ZXh0Q29udGVudCA9IHN1bnNldDtcbiAgICBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jdXJyZW50IC5odW1pZGl0eScpLnRleHRDb250ZW50ID1cbiAgICAgIE1hdGgucm91bmQoaHVtaWRpdHkpICsgJyUnO1xuICAgIGNhcmQucXVlcnlTZWxlY3RvcignLmN1cnJlbnQgLndpbmQgLnZhbHVlJykudGV4dENvbnRlbnQgPVxuICAgICAgTWF0aC5yb3VuZCh3aW5kLnNwZWVkKTtcbiAgICBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jdXJyZW50IC53aW5kIC5kaXJlY3Rpb24nKS50ZXh0Q29udGVudCA9IHdpbmQuZGlyZWN0aW9uO1xuICAgIHZhciBuZXh0RGF5cyA9IGNhcmQucXVlcnlTZWxlY3RvckFsbCgnLmZ1dHVyZSAub25lZGF5Jyk7XG4gICAgdmFyIHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICB0b2RheSA9IHRvZGF5LmdldERheSgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNzsgaSsrKSB7XG4gICAgICB2YXIgbmV4dERheSA9IG5leHREYXlzW2ldO1xuICAgICAgdmFyIGRhaWx5ID0gZGF0YS5jaGFubmVsLml0ZW0uZm9yZWNhc3RbaV07XG4gICAgICBpZiAoZGFpbHkgJiYgbmV4dERheSkge1xuICAgICAgICBuZXh0RGF5LnF1ZXJ5U2VsZWN0b3IoJy5kYXRlJykudGV4dENvbnRlbnQgPVxuICAgICAgICAgIGFwcC5kYXlzT2ZXZWVrWyhpICsgdG9kYXkpICUgN107XG4gICAgICAgIG5leHREYXkucXVlcnlTZWxlY3RvcignLmljb24nKS5jbGFzc0xpc3QuYWRkKGFwcC5nZXRJY29uQ2xhc3MoZGFpbHkuY29kZSkpO1xuICAgICAgICBuZXh0RGF5LnF1ZXJ5U2VsZWN0b3IoJy50ZW1wLWhpZ2ggLnZhbHVlJykudGV4dENvbnRlbnQgPVxuICAgICAgICAgIE1hdGgucm91bmQoZGFpbHkuaGlnaCk7XG4gICAgICAgIG5leHREYXkucXVlcnlTZWxlY3RvcignLnRlbXAtbG93IC52YWx1ZScpLnRleHRDb250ZW50ID1cbiAgICAgICAgICBNYXRoLnJvdW5kKGRhaWx5Lmxvdyk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChhcHAuaXNMb2FkaW5nKSB7XG4gICAgICBhcHAuc3Bpbm5lci5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsIHRydWUpO1xuICAgICAgYXBwLmNvbnRhaW5lci5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpO1xuICAgICAgYXBwLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgIH1cbiAgfTtcblxuXG4gIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgKlxuICAgKiBNZXRob2RzIGZvciBkZWFsaW5nIHdpdGggdGhlIG1vZGVsXG4gICAqXG4gICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gIC8qXG4gICAqIEdldHMgYSBmb3JlY2FzdCBmb3IgYSBzcGVjaWZpYyBjaXR5IGFuZCB1cGRhdGVzIHRoZSBjYXJkIHdpdGggdGhlIGRhdGEuXG4gICAqIGdldEZvcmVjYXN0KCkgZmlyc3QgY2hlY2tzIGlmIHRoZSB3ZWF0aGVyIGRhdGEgaXMgaW4gdGhlIGNhY2hlLiBJZiBzbyxcbiAgICogdGhlbiBpdCBnZXRzIHRoYXQgZGF0YSBhbmQgcG9wdWxhdGVzIHRoZSBjYXJkIHdpdGggdGhlIGNhY2hlZCBkYXRhLlxuICAgKiBUaGVuLCBnZXRGb3JlY2FzdCgpIGdvZXMgdG8gdGhlIG5ldHdvcmsgZm9yIGZyZXNoIGRhdGEuIElmIHRoZSBuZXR3b3JrXG4gICAqIHJlcXVlc3QgZ29lcyB0aHJvdWdoLCB0aGVuIHRoZSBjYXJkIGdldHMgdXBkYXRlZCBhIHNlY29uZCB0aW1lIHdpdGggdGhlXG4gICAqIGZyZXNoZXN0IGRhdGEuXG4gICAqL1xuICBhcHAuZ2V0Rm9yZWNhc3QgPSBmdW5jdGlvbihrZXksIGxhYmVsKSB7XG4gICAgdmFyIHN0YXRlbWVudCA9ICdzZWxlY3QgKiBmcm9tIHdlYXRoZXIuZm9yZWNhc3Qgd2hlcmUgd29laWQ9JyArIGtleTtcbiAgICB2YXIgdXJsID0gJ2h0dHBzOi8vcXVlcnkueWFob29hcGlzLmNvbS92MS9wdWJsaWMveXFsP2Zvcm1hdD1qc29uJnE9JyArXG4gICAgICAgIHN0YXRlbWVudDtcbiAgICAvLyBUT0RPIGFkZCBjYWNoZSBsb2dpYyBoZXJlXG4gICAgaWYgKCdjYWNoZXMnIGluIHdpbmRvdykge1xuICAgICAgLypcbiAgICAgICAqIENoZWNrIGlmIHRoZSBzZXJ2aWNlIHdvcmtlciBoYXMgYWxyZWFkeSBjYWNoZWQgdGhpcyBjaXR5J3Mgd2VhdGhlclxuICAgICAgICogZGF0YS4gSWYgdGhlIHNlcnZpY2Ugd29ya2VyIGhhcyB0aGUgZGF0YSwgdGhlbiBkaXNwbGF5IHRoZSBjYWNoZWRcbiAgICAgICAqIGRhdGEgd2hpbGUgdGhlIGFwcCBmZXRjaGVzIHRoZSBsYXRlc3QgZGF0YS5cbiAgICAgICAqL1xuICAgICAgY2FjaGVzLm1hdGNoKHVybCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UpIHtcbiAgICAgICAgICByZXNwb25zZS5qc29uKCkudGhlbihmdW5jdGlvbiB1cGRhdGVGcm9tQ2FjaGUoanNvbikge1xuICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBqc29uLnF1ZXJ5LnJlc3VsdHM7XG4gICAgICAgICAgICByZXN1bHRzLmtleSA9IGtleTtcbiAgICAgICAgICAgIHJlc3VsdHMubGFiZWwgPSBsYWJlbDtcbiAgICAgICAgICAgIHJlc3VsdHMuY3JlYXRlZCA9IGpzb24ucXVlcnkuY3JlYXRlZDtcbiAgICAgICAgICAgIGFwcC51cGRhdGVGb3JlY2FzdENhcmQocmVzdWx0cyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBGZXRjaCB0aGUgbGF0ZXN0IGRhdGEuXG4gICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICByZXF1ZXN0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHJlcXVlc3QucmVhZHlTdGF0ZSA9PT0gWE1MSHR0cFJlcXVlc3QuRE9ORSkge1xuICAgICAgICBpZiAocmVxdWVzdC5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICAgIHZhciByZXNwb25zZSA9IEpTT04ucGFyc2UocmVxdWVzdC5yZXNwb25zZSk7XG4gICAgICAgICAgdmFyIHJlc3VsdHMgPSByZXNwb25zZS5xdWVyeS5yZXN1bHRzO1xuICAgICAgICAgIHJlc3VsdHMua2V5ID0ga2V5O1xuICAgICAgICAgIHJlc3VsdHMubGFiZWwgPSBsYWJlbDtcbiAgICAgICAgICByZXN1bHRzLmNyZWF0ZWQgPSByZXNwb25zZS5xdWVyeS5jcmVhdGVkO1xuICAgICAgICAgIGFwcC51cGRhdGVGb3JlY2FzdENhcmQocmVzdWx0cyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFJldHVybiB0aGUgaW5pdGlhbCB3ZWF0aGVyIGZvcmVjYXN0IHNpbmNlIG5vIGRhdGEgaXMgYXZhaWxhYmxlLlxuICAgICAgICBhcHAudXBkYXRlRm9yZWNhc3RDYXJkKGluaXRpYWxXZWF0aGVyRm9yZWNhc3QpO1xuICAgICAgfVxuICAgIH07XG4gICAgcmVxdWVzdC5vcGVuKCdHRVQnLCB1cmwpO1xuICAgIHJlcXVlc3Quc2VuZCgpO1xuICB9O1xuXG4gIC8vIEl0ZXJhdGUgYWxsIG9mIHRoZSBjYXJkcyBhbmQgYXR0ZW1wdCB0byBnZXQgdGhlIGxhdGVzdCBmb3JlY2FzdCBkYXRhXG4gIGFwcC51cGRhdGVGb3JlY2FzdHMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGFwcC52aXNpYmxlQ2FyZHMpO1xuICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAgIGFwcC5nZXRGb3JlY2FzdChrZXkpO1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIFRPRE8gYWRkIHNhdmVTZWxlY3RlZENpdGllcyBmdW5jdGlvbiBoZXJlXG4gIC8vIFNhdmUgbGlzdCBvZiBjaXRpZXMgdG8gbG9jYWxTdG9yYWdlLlxuICBhcHAuc2F2ZVNlbGVjdGVkQ2l0aWVzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNlbGVjdGVkQ2l0aWVzID0gSlNPTi5zdHJpbmdpZnkoYXBwLnNlbGVjdGVkQ2l0aWVzKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2VsZWN0ZWRDaXRpZXMgPSBzZWxlY3RlZENpdGllcztcbiAgfTtcblxuICBhcHAuZ2V0SWNvbkNsYXNzID0gZnVuY3Rpb24od2VhdGhlckNvZGUpIHtcbiAgICAvLyBXZWF0aGVyIGNvZGVzOiBodHRwczovL2RldmVsb3Blci55YWhvby5jb20vd2VhdGhlci9kb2N1bWVudGF0aW9uLmh0bWwjY29kZXNcbiAgICB3ZWF0aGVyQ29kZSA9IHBhcnNlSW50KHdlYXRoZXJDb2RlKTtcbiAgICBzd2l0Y2ggKHdlYXRoZXJDb2RlKSB7XG4gICAgICBjYXNlIDI1OiAvLyBjb2xkXG4gICAgICBjYXNlIDMyOiAvLyBzdW5ueVxuICAgICAgY2FzZSAzMzogLy8gZmFpciAobmlnaHQpXG4gICAgICBjYXNlIDM0OiAvLyBmYWlyIChkYXkpXG4gICAgICBjYXNlIDM2OiAvLyBob3RcbiAgICAgIGNhc2UgMzIwMDogLy8gbm90IGF2YWlsYWJsZVxuICAgICAgICByZXR1cm4gJ2NsZWFyLWRheSc7XG4gICAgICBjYXNlIDA6IC8vIHRvcm5hZG9cbiAgICAgIGNhc2UgMTogLy8gdHJvcGljYWwgc3Rvcm1cbiAgICAgIGNhc2UgMjogLy8gaHVycmljYW5lXG4gICAgICBjYXNlIDY6IC8vIG1peGVkIHJhaW4gYW5kIHNsZWV0XG4gICAgICBjYXNlIDg6IC8vIGZyZWV6aW5nIGRyaXp6bGVcbiAgICAgIGNhc2UgOTogLy8gZHJpenpsZVxuICAgICAgY2FzZSAxMDogLy8gZnJlZXppbmcgcmFpblxuICAgICAgY2FzZSAxMTogLy8gc2hvd2Vyc1xuICAgICAgY2FzZSAxMjogLy8gc2hvd2Vyc1xuICAgICAgY2FzZSAxNzogLy8gaGFpbFxuICAgICAgY2FzZSAzNTogLy8gbWl4ZWQgcmFpbiBhbmQgaGFpbFxuICAgICAgY2FzZSA0MDogLy8gc2NhdHRlcmVkIHNob3dlcnNcbiAgICAgICAgcmV0dXJuICdyYWluJztcbiAgICAgIGNhc2UgMzogLy8gc2V2ZXJlIHRodW5kZXJzdG9ybXNcbiAgICAgIGNhc2UgNDogLy8gdGh1bmRlcnN0b3Jtc1xuICAgICAgY2FzZSAzNzogLy8gaXNvbGF0ZWQgdGh1bmRlcnN0b3Jtc1xuICAgICAgY2FzZSAzODogLy8gc2NhdHRlcmVkIHRodW5kZXJzdG9ybXNcbiAgICAgIGNhc2UgMzk6IC8vIHNjYXR0ZXJlZCB0aHVuZGVyc3Rvcm1zIChub3QgYSB0eXBvKVxuICAgICAgY2FzZSA0NTogLy8gdGh1bmRlcnNob3dlcnNcbiAgICAgIGNhc2UgNDc6IC8vIGlzb2xhdGVkIHRodW5kZXJzaG93ZXJzXG4gICAgICAgIHJldHVybiAndGh1bmRlcnN0b3Jtcyc7XG4gICAgICBjYXNlIDU6IC8vIG1peGVkIHJhaW4gYW5kIHNub3dcbiAgICAgIGNhc2UgNzogLy8gbWl4ZWQgc25vdyBhbmQgc2xlZXRcbiAgICAgIGNhc2UgMTM6IC8vIHNub3cgZmx1cnJpZXNcbiAgICAgIGNhc2UgMTQ6IC8vIGxpZ2h0IHNub3cgc2hvd2Vyc1xuICAgICAgY2FzZSAxNjogLy8gc25vd1xuICAgICAgY2FzZSAxODogLy8gc2xlZXRcbiAgICAgIGNhc2UgNDE6IC8vIGhlYXZ5IHNub3dcbiAgICAgIGNhc2UgNDI6IC8vIHNjYXR0ZXJlZCBzbm93IHNob3dlcnNcbiAgICAgIGNhc2UgNDM6IC8vIGhlYXZ5IHNub3dcbiAgICAgIGNhc2UgNDY6IC8vIHNub3cgc2hvd2Vyc1xuICAgICAgICByZXR1cm4gJ3Nub3cnO1xuICAgICAgY2FzZSAxNTogLy8gYmxvd2luZyBzbm93XG4gICAgICBjYXNlIDE5OiAvLyBkdXN0XG4gICAgICBjYXNlIDIwOiAvLyBmb2dneVxuICAgICAgY2FzZSAyMTogLy8gaGF6ZVxuICAgICAgY2FzZSAyMjogLy8gc21va3lcbiAgICAgICAgcmV0dXJuICdmb2cnO1xuICAgICAgY2FzZSAyNDogLy8gd2luZHlcbiAgICAgIGNhc2UgMjM6IC8vIGJsdXN0ZXJ5XG4gICAgICAgIHJldHVybiAnd2luZHknO1xuICAgICAgY2FzZSAyNjogLy8gY2xvdWR5XG4gICAgICBjYXNlIDI3OiAvLyBtb3N0bHkgY2xvdWR5IChuaWdodClcbiAgICAgIGNhc2UgMjg6IC8vIG1vc3RseSBjbG91ZHkgKGRheSlcbiAgICAgIGNhc2UgMzE6IC8vIGNsZWFyIChuaWdodClcbiAgICAgICAgcmV0dXJuICdjbG91ZHknO1xuICAgICAgY2FzZSAyOTogLy8gcGFydGx5IGNsb3VkeSAobmlnaHQpXG4gICAgICBjYXNlIDMwOiAvLyBwYXJ0bHkgY2xvdWR5IChkYXkpXG4gICAgICBjYXNlIDQ0OiAvLyBwYXJ0bHkgY2xvdWR5XG4gICAgICAgIHJldHVybiAncGFydGx5LWNsb3VkeS1kYXknO1xuICAgIH1cbiAgfTtcblxuICAvKlxuICAgKiBGYWtlIHdlYXRoZXIgZGF0YSB0aGF0IGlzIHByZXNlbnRlZCB3aGVuIHRoZSB1c2VyIGZpcnN0IHVzZXMgdGhlIGFwcCxcbiAgICogb3Igd2hlbiB0aGUgdXNlciBoYXMgbm90IHNhdmVkIGFueSBjaXRpZXMuIFNlZSBzdGFydHVwIGNvZGUgZm9yIG1vcmVcbiAgICogZGlzY3Vzc2lvbi5cbiAgICovXG4gIHZhciBpbml0aWFsV2VhdGhlckZvcmVjYXN0ID0ge1xuICAgIGtleTogJzI0NTkxMTUnLFxuICAgIGxhYmVsOiAnTmV3IFlvcmssIE5ZJyxcbiAgICBjcmVhdGVkOiAnMjAxNi0wNy0yMlQwMTowMDowMFonLFxuICAgIGNoYW5uZWw6IHtcbiAgICAgIGFzdHJvbm9teToge1xuICAgICAgICBzdW5yaXNlOiBcIjU6NDMgYW1cIixcbiAgICAgICAgc3Vuc2V0OiBcIjg6MjEgcG1cIlxuICAgICAgfSxcbiAgICAgIGl0ZW06IHtcbiAgICAgICAgY29uZGl0aW9uOiB7XG4gICAgICAgICAgdGV4dDogXCJXaW5keVwiLFxuICAgICAgICAgIGRhdGU6IFwiVGh1LCAyMSBKdWwgMjAxNiAwOTowMCBQTSBFRFRcIixcbiAgICAgICAgICB0ZW1wOiA1NixcbiAgICAgICAgICBjb2RlOiAyNFxuICAgICAgICB9LFxuICAgICAgICBmb3JlY2FzdDogW1xuICAgICAgICAgIHtjb2RlOiA0NCwgaGlnaDogODYsIGxvdzogNzB9LFxuICAgICAgICAgIHtjb2RlOiA0NCwgaGlnaDogOTQsIGxvdzogNzN9LFxuICAgICAgICAgIHtjb2RlOiA0LCBoaWdoOiA5NSwgbG93OiA3OH0sXG4gICAgICAgICAge2NvZGU6IDI0LCBoaWdoOiA3NSwgbG93OiA4OX0sXG4gICAgICAgICAge2NvZGU6IDI0LCBoaWdoOiA4OSwgbG93OiA3N30sXG4gICAgICAgICAge2NvZGU6IDQ0LCBoaWdoOiA5MiwgbG93OiA3OX0sXG4gICAgICAgICAge2NvZGU6IDQ0LCBoaWdoOiA4OSwgbG93OiA3N31cbiAgICAgICAgXVxuICAgICAgfSxcbiAgICAgIGF0bW9zcGhlcmU6IHtcbiAgICAgICAgaHVtaWRpdHk6IDU2XG4gICAgICB9LFxuICAgICAgd2luZDoge1xuICAgICAgICBzcGVlZDogMjUsXG4gICAgICAgIGRpcmVjdGlvbjogMTk1XG4gICAgICB9XG4gICAgfVxuICB9O1xuICAvLyBUT0RPIHVuY29tbWVudCBsaW5lIGJlbG93IHRvIHRlc3QgYXBwIHdpdGggZmFrZSBkYXRhXG4gIC8vIGFwcC51cGRhdGVGb3JlY2FzdENhcmQoaW5pdGlhbFdlYXRoZXJGb3JlY2FzdCk7XG5cbiAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgKlxuICAgKiBDb2RlIHJlcXVpcmVkIHRvIHN0YXJ0IHRoZSBhcHBcbiAgICpcbiAgICogTk9URTogVG8gc2ltcGxpZnkgdGhpcyBjb2RlbGFiLCB3ZSd2ZSB1c2VkIGxvY2FsU3RvcmFnZS5cbiAgICogICBsb2NhbFN0b3JhZ2UgaXMgYSBzeW5jaHJvbm91cyBBUEkgYW5kIGhhcyBzZXJpb3VzIHBlcmZvcm1hbmNlXG4gICAqICAgaW1wbGljYXRpb25zLiBJdCBzaG91bGQgbm90IGJlIHVzZWQgaW4gcHJvZHVjdGlvbiBhcHBsaWNhdGlvbnMhXG4gICAqICAgSW5zdGVhZCwgY2hlY2sgb3V0IElEQiAoaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvaWRiKSBvclxuICAgKiAgIFNpbXBsZURCIChodHRwczovL2dpc3QuZ2l0aHViLmNvbS9pbmV4b3JhYmxldGFzaC9jODA2OWMwNDJiNzM0NTE5NjgwYylcbiAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAvLyBUT0RPIGFkZCBzdGFydHVwIGNvZGUgaGVyZVxuICBhcHAuc2VsZWN0ZWRDaXRpZXMgPSBsb2NhbFN0b3JhZ2Uuc2VsZWN0ZWRDaXRpZXM7XG4gIGlmIChhcHAuc2VsZWN0ZWRDaXRpZXMpIHtcbiAgICBhcHAuc2VsZWN0ZWRDaXRpZXMgPSBKU09OLnBhcnNlKGFwcC5zZWxlY3RlZENpdGllcyk7XG4gICAgYXBwLnNlbGVjdGVkQ2l0aWVzLmZvckVhY2goZnVuY3Rpb24oY2l0eSkge1xuICAgICAgYXBwLmdldEZvcmVjYXN0KGNpdHkua2V5LCBjaXR5LmxhYmVsKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICAvKiBUaGUgdXNlciBpcyB1c2luZyB0aGUgYXBwIGZvciB0aGUgZmlyc3QgdGltZSwgb3IgdGhlIHVzZXIgaGFzIG5vdFxuICAgICAqIHNhdmVkIGFueSBjaXRpZXMsIHNvIHNob3cgdGhlIHVzZXIgc29tZSBmYWtlIGRhdGEuIEEgcmVhbCBhcHAgaW4gdGhpc1xuICAgICAqIHNjZW5hcmlvIGNvdWxkIGd1ZXNzIHRoZSB1c2VyJ3MgbG9jYXRpb24gdmlhIElQIGxvb2t1cCBhbmQgdGhlbiBpbmplY3RcbiAgICAgKiB0aGF0IGRhdGEgaW50byB0aGUgcGFnZS5cbiAgICAgKi9cbiAgICBhcHAudXBkYXRlRm9yZWNhc3RDYXJkKGluaXRpYWxXZWF0aGVyRm9yZWNhc3QpO1xuICAgIGFwcC5zZWxlY3RlZENpdGllcyA9IFtcbiAgICAgIHtrZXk6IGluaXRpYWxXZWF0aGVyRm9yZWNhc3Qua2V5LCBsYWJlbDogaW5pdGlhbFdlYXRoZXJGb3JlY2FzdC5sYWJlbH1cbiAgICBdO1xuICAgIGFwcC5zYXZlU2VsZWN0ZWRDaXRpZXMoKTtcbiAgfVxuXG4gIC8vIFRPRE8gYWRkIHNlcnZpY2Ugd29ya2VyIGNvZGUgaGVyZVxuICBpZiAoJ3NlcnZpY2VXb3JrZXInIGluIG5hdmlnYXRvcikge1xuICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyXG4gICAgICAgICAgICAgLnJlZ2lzdGVyKCcuL3NlcnZpY2Utd29ya2VyLmpzJylcbiAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHsgY29uc29sZS5sb2coJ1NlcnZpY2UgV29ya2VyIFJlZ2lzdGVyZWQnKTsgfSk7XG4gIH1cbn0pKCk7XG4iXX0=
